<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="crm_case_form_view_helpdesk">
            <field name="name">CRM - Helpdesk Support Form</field>
            <field name="model">crm.helpdesk</field>
            <field name="inherit_id"
                   ref="crm_helpdesk.crm_case_form_view_helpdesk"/>
            <field name="arch" type="xml">
                <xpath expr="//group[@class='oe_header']" position="before">
                    <div class="oe_button_box">
                        <button type="object"  name="action_view_rma_customer"
                                class="oe_stat_button"
                                icon="fa-eject"
                                attrs="{'invisible': [('rma_count', '=', 0)]}"
                                groups="rma.group_rma_customer_user,rma.group_rma_supplier_user">
                            <field name="rma_count" widget="statinfo"
                                   string="RMA"/>
                        </button>
                    </div>
                </xpath>
                <field name="state" position="before">
                    <button name="%(crm_helpdesk_rma.action_helpdesk_rma_customer)d"
                            string="Create RMA"
                            type="action"
                            context="{'default_originating_helpdesk_id': active_id, 'default_partner_id': partner_id}"
                            groups="rma.group_rma_customer_user">
                    </button>
                </field>
                <notebook position="inside">
                    <page name="rma" string="RMA lines">
                        <field name="rma_order_line_ids" nolabel="1" create="false"/>
                    </page>
                </notebook>
            </field>
        </record>

    </data>
</openerp>
